---
layout: post
title:  "DETR ë…¼ë¬¸ ë¦¬ë·°"
date:   2021-06-23 12:07:22
description: "DETR ë…¼ë¬¸ë¦¬ë·°"
categories: jekyll
---

ë…¼ë¬¸ ì •ë¦¬ê°€ ì£¼ ëª©ì ì´ë¼ ê¸€ì´ ë‚œì¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ğŸ˜‚

Object Detection ë¶„ì•¼ì˜ ëŒ€í‘œì ì¸ ëª¨ë¸ë“¤ì¸ YOLO, Mask R-CNN, Faster R-CNNë¥¼ ë¹„ë¡¯í•œ ë§ì€ ëª¨ë¸ë“¤ì´ anchor, NMSì™€ ê°™ì€ ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ”ë° ì´ ë°©ë²•ë“¤ì´ indirectí•œ ë°©ë²•ì¸ë°

ì–´ë–»ê²Œ ì„¤ê³„í•˜ëŠëƒì— ë”°ë¼ ì„±ëŠ¥ì´ ë§ì´ ì˜í–¥ì„ ë°›ëŠ” ì ì„ í•´ê²°í•˜ê³ ì directí•œ ë°©ë²•ìœ¼ë¡œ Object Detectionë¥¼ í•´ê²°í•˜ê³ ì DETRë¥¼ ê³ ì•ˆí–ˆë‹¤ê³  í•©ë‹ˆë‹¤.

DETRì€ bipartite matching lossì™€ transformerë¥¼ ì‚¬ìš©í–ˆë‹¤ëŠ” ê²ƒì´ íŠ¹ì§•ì¸ë° ë¨¼ì € bipartite matching loss ë¶€í„° ì„¤ëª…í• ê»˜ìš”.
![detr1](/assets/images/detr_asset/detr1.png)

DETR ëª¨ë¸ì˜ ì¶”ë¡  ê²°ê³¼ì™€ ground truthë¥¼ ì´ìš©í•´ lossë¥¼ ê³„ì‚°í•  ê±´ë° ëª¨ë¸ì˜ ì¶”ë¡  ê²°ê³¼ì— í•´ë‹¹í•˜ëŠ” ground truthê°€ ì–´ë–¤ ê²ƒì¸ì§€ ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œìš”?  í—ê°€ë¦¬ì•ˆ ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•´

![detr2](/assets/images/detr_asset/detr2.png)

L_matchê°’ì˜ í•©ì„ ìµœì†Œë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ì¡°í•©?ì„ êµ¬í•˜ê³  ê·¸ ì¡°í•©ì— ë”°ë¼

![detr3](/assets/images/detr_asset/detr3.png)

lossë¥¼ ê³„ì‚°í•˜ëŠ”ê²ë‹ˆë‹¤. lossëŠ” giou loss, l1 loss, cross entropyë¥¼ ì´ìš©í•´ ê³„ì‚°í•©ë‹ˆë‹¤. ì¦‰ í—ê°€ë¦¬ì•ˆ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ L_match ê°’ì˜ í•©ì„ ìµœì†Œë¡œ ë§Œë“¤ì–´ ì£¼ëŠ” ì¡°í•©ì„ ì°¾ê³  lossë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ëª¨ë¸ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. 50ì¤„ ë‚´ë¡œ(inference) êµ¬í˜„í•  ìˆ˜ ìˆë‹¤ê³  í• ì •ë„ë¡œ ê¸°ì¡´ì˜ cnn backbone + transformer + 3ì¸µì˜ fc layer ì¡°í•©ìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆê³  ëª¨ë“  pairwiseë“¤ ê°„ì˜ interactionì´ ê°€ëŠ¥í•œ self attentionìœ¼ë¡œ ì¤‘ë³µëœ ì¶”ë¡  ê²°ê³¼ë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ transformerë¥¼ ì‚¬ìš©í–ˆë‹¤ê³  í•©ë‹ˆë‹¤.

![detr4](/assets/images/detr_asset/detr4.png)

ì‹¤í—˜ íŒŒíŠ¸ì— ë§ì€ ë‚´ìš©ì´ ìˆì—ˆëŠ”ë° í¥ë¯¸ë¡œì› ë˜ ë¶€ë¶„ë§Œ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤ğŸ˜‚ 

![detr5](/assets/images/detr_asset/detr5.png)

encoder, decoder attention ë¶€ë¶„ì´ ê°€ì¥ í¥ë¯¸ë¡œì› ëŠ”ë°ìš” encoderì˜ ê°œìˆ˜ê°€ ë§ì„ ìˆ˜ë¡ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì˜€ê³  ë§ˆì§€ë§‰ encoderì˜ attention map ê´€ì°°ë¡œ encoderê°€ objectë“¤ì„ ë¶„ë¦¬í•˜ëŠ” ì—­í™œì„ í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤ê³  í•©ë‹ˆë‹¤

![detr6](/assets/images/detr_asset/detr6.png)

decoder ì—­ì‹œ ê°œìˆ˜ê°€ ë§ì„ ìˆ˜ë¡ ì„±ëŠ¥ì´ ë†’ì•„ì¡Œê³  ê°œìˆ˜ê°€ ë§ì•„ ì§ˆ ìˆ˜ë¡ NMS ì ìš©í•œ ê²°ê³¼ì™€ ì°¨ì´ê°€ ì¤„ì–´ë“¬ì„ ê´€ì°° í•  ìˆ˜ ìˆì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.

![detr7](/assets/images/detr_asset/detr7.png)

ê·¸ë¦¬ê³  decoderëŠ” ê²½ê³„ êµ¬ë¶„ì„ ìœ„í•œ ì¤‘ìš” pointë“¤?ì„ attendí•œë‹¤ê³  í•©ë‹ˆë‹¤. ì—¬ê¸° ì‚¬ì§„ì—ì„œëŠ” ì½”ë¼ë¦¬ì˜ ì½”, ë°œì´ë„¤ìš”

[https://github.com/facebookresearch/detr](https://github.com/facebookresearch/detr)

ì½”ë“œëŠ” ì—¬ê¸°ì„œ ë³¼ ìˆ˜ ìˆì–´ìš”!

ê¶ê¸ˆí•œì ?

  1. object queryëŠ” ë¬´ì—‡ì¼ê¹Œìš”? í•™ìŠµì‹œí‚¨ positional embeddingì´ë¼ê³  í•˜ê³  inference ì†ŒìŠ¤ ì½”ë“œì—ëŠ” randomí•œ ê°’ìœ¼ë¡œ ë˜ì–´ìˆëŠ”ë° ì¢€ ë” ì°¾ì•„ë´ì•¼ê² ë„¤ìš”
  2. Yoloë‚˜ Mask R-CNN, Faster R-CNNê³¼ ê°™ì€ ê¸°ì¡´ ë°©ë²•ë“¤ì€ ì–´ë–»ê²Œ í–ˆë‚˜? ì´ê±´ ë…¸ì˜¤ë ¥ì„ ë” í•˜ê² ìŠµë‹ˆë‹¤,,
